openapi: "3.0.0"
info:
  title: Digital Assets API
  description: Digital Assets API exposes the method to retrieve different types of digital assets <p> GET method to retrieve digital assets for a specific style-fabric-color and brand <p> GET method to retrieve main digital assets for list of ordered items
  version: "1.0.0"
servers:
  - url: '{protocol}://{environment}.gateway.webmethodscloud.de/gateway/digital-assets/v1'
    variables:
      protocol:
        enum:
          - https
        default: https
      environment:
        default: apiarmani    # Production server
        enum:
          - apiarmani      # Production server
          - apiarmanidev   # Development server

paths:

  /media-items/brands/{brand-id}:
    get:
      description: Return URLs of all media items stored in DAM (main image) for the brand specified as path parameter
      parameters:
        - name: brand-id
          in: path
          description: brand the search refers to
          required: true
          explode: true
          schema:
            type: string
            enum:
              - ga
              - ea
              - ea7
              - ax
            example: "ga"
      responses:
        "200":
          description: Successful Operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/url-collection"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "405":
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "429":
          description: Too Many Requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "502":
          description: Bad Gateway
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/error"
        "503":
          description: Service Not Available
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "504":
          description: Gateway Timeout
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
      
  /media-items/:
    get:
      description: Return URLs of media items for the specified item-id, i.e. images and / or video
      parameters:
        - name: style
          in: query
          description: ID of the style of the item the query refers to
          required: true
          schema:
            $ref: "#/components/schemas/style"
        - name: fabric
          in: query
          description: ID of the fabric of the item the query refers to
          required: true
          schema:
            $ref: "#/components/schemas/fabric"
        - name: color
          in: query
          description: ID of the color of the item the query refers to
          required: true
          schema: 
            $ref: "#/components/schemas/color"
        - name: brand
          in: query
          description: ID of the brand the query refers to
          required: true
          schema:
            $ref: "#/components/schemas/brand"
        - name: category
          in: query
          description: Requester of the image (sales, web, social media)
          required: false
          schema:
            $ref: "#/components/schemas/category"
        - name: classification
          in: query
          description: The classification of the content, i.e. the views (main,front,side,back etc. )
          required: false
          explode: true
          schema:
            $ref: "#/components/schemas/classification"
        - name: size
          in: query
          description: The resolution of the image ("300", "600", "1200")
          required: false
          schema:
            $ref: "#/components/schemas/resolution"
        - name: season
          in: query
          description: The season the query refers to
          required: false
          schema:
            $ref: "#/components/schemas/season"
        - name: transaction-id
          in: header
          description: unique identifier of the transaction to be propagated to downstream servers, if not included by the Application calling the API it will be generated by the API Gateway
          required: false
          schema:
            type: string
            format: uuid
        - name: x-Gateway-APIKey
          in: header
          description: API Key assigned to the Application calling the API
          required: true
          schema:
            type: string
            
      responses:
        "200":
          description: Successful Operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/multi-items-digital-assets"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "405":
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "429":
          description: Too Many Requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "502":
          description: Bad Gateway
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/error"
        "503":
          description: Service Not Available
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "504":
          description: Gateway Timeout
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
                
    
    
security:
  - api-key-auth: []

components:

  securitySchemes:
    api-key-auth:
      type: apiKey
      in: header
      name: x-Gateway-APIKey

  schemas:
      
    bulk-retrieve-response:
      type: object
      required:
        - task-id
      properties:
        task-id:
          description: Unique identifier of the background asynchronous task (assigned by the backend system)
          type: string
          
    multi-items-digital-assets:
      description: add here the description
      type: array
      items:
        $ref: "#/components/schemas/digital-assets"
        
    multi-items-sketches-digital-assets:
      description: add here the description
      type: array
      items:
        $ref: "#/components/schemas/sketches-digital-assets"
        
    multi-items-swatches-digital-assets:
      description: add here the description
      type: array
      items:
        $ref: "#/components/schemas/swatches-digital-assets"
        
    sketches-digital-assets:
      type: object
      description: object encapsulating properties of the digitial asset
      required:
        - item-type
        - item-id
        - href
        - brand
        - gender
        - assets
      properties:
        item-type:
          description: type of item identifier (generic, sku, style)
          type: string
          example: "SFC"
        item-id:
          description: Unique identifier of the sketch
          type: string
          example: "2WHGK03H"
        brand:
          $ref: "#/components/schemas/brand"
        gender:
          description: Gender the product item refers to
          type: string
          example: "M"
        asset-category:
          $ref: "#/components/schemas/category"
        assets:
          description: Array of objets carrying the digital assets corresponding to the item
          type: array
          items:
            $ref: "#/components/schemas/sketches-assets"
            
    swatches-digital-assets:
      type: object
      description: object encapsulating properties of the digitial asset
      required:
        - item-type
        - item-id
        - href
        - brand
        - gender
        - assets
      properties:
        item-type:
          description: type of item identifier (generic, sku, style)
          type: string
          example: "SFC"
        item-id:
          description: Unique identifier of the sketch
          type: string
          example: "SM17Z-F8G8"
        brand:
          $ref: "#/components/schemas/brand"
        gender:
          description: Gender the product item refers to
          type: string
          example: "M"
        asset-category:
          $ref: "#/components/schemas/category"
        assets:
          description: Array of objets carrying the digital assets corresponding to the item
          type: array
          items:
            $ref: "#/components/schemas/swatches-assets"
            
    digital-assets:
      type: object
      description: object encapsulating properties of the digitial asset
      required:
        - item-id-type
        - item-id
        - href
        - brand
        - gender
        - assets
      properties:
        item-id-type:
          description: type of item identifier (generic, sku, style-fabric-color)
          type: string
          enum:
            - "SFC"
            - "SKU"
          example: "SFC"
        item-id:
          description: Unique identifier of the item (if item-id-type is SFC item-id is style_fabric_color)
          type: string
          example: "2WHGK03H_T01QW_UC99"
        style:
          description: The identifier of the style
          type: string
        fabric:
          description: The identifier of the fabric
          type: string
        color:
          description: The identifier of the color
          type: string
        brand:
          $ref: "#/components/schemas/brand"
        gender:
          description: Gender the product item refers to
          type: string
          example: "M"
        category:
          $ref: "#/components/schemas/category"
        count:
          description: Number of assets returned
          type: integer
          example: 1
        assets:
          description: Array of objets carrying the digital assets corresponding to the item
          type: array
          items:
            $ref: "#/components/schemas/assets"
        related-items:
          $ref: "#/components/schemas/related-items"
       
    
    related-items:
      type: object
      properties:
        sketches:
          type: array
          items:
            $ref: "#/components/schemas/sketch"
        swatches:
          type: array
          items:
            $ref: "#/components/schemas/swatch"
    
    sketch:
      type: object
      properties:
        id:
          type: string
          example: "3R2A6B"
        resolution:
          $ref: "#/components/schemas/resolution"
        size:
          description: The size in bytes of the sketch asset
          type: integer
          example: 345667
        url:
          description: The URL of the sketch asset
          type: string
          format: uri
          example: "https://dam.armani.it/asset/transform.GAMIPIC-Y4R173-S.600.jpg"
        href:
          type: string
          format: uri
          example: "https://apiarmanidev.gateway.webmethodscloud.de/gateway/digital-assets/v1/sketches?Y4R173&size=600"
        creation-date:
          type: string
          format: date-time
        last-change-date:
          type: string
          format: date-time
          
    swatch:
      type: object
      properties:
        id:
          type: string
          example: "Y068E_85726"
        resolution:
          $ref: "#/components/schemas/resolution"
        size:
          description: The size in bytes of the sketch asset
          type: integer
          example: 345667
        url:
          description: The URL of the sketch asset
          type: string
          format: uri
          example: "https://dam.armani.it/asset/transform.GAMIPIC-Y068E_85726-T.600.jpg"
        href:
          type: string
          format: uri
          example: "https://apiarmanidev.gateway.webmethodscloud.de/gateway/digital-assets/v1/swatches?style=Y4R173&fabric=Y068E&color=85726&size=600"
        creation-date:
          type: string
          format: date-time
        last-change-date:
          type: string
          format: date-time  
    
    category:
      type: string
      enum:
        - sales
        - web
        - social
        - all
      example: web
      
    season:
      type: string
      example: "FW2022"

    asset-type:
      type: string
      enum:
        - image
        - video
        - 3d
        - swatch
        - sketch

    assets:
      type: object
      properties:
        asset-type:
          allOf:
            - $ref: "#/components/schemas/asset-type"
          example: image
        asset-category:
          $ref: "#/components/schemas/category"
        asset-classification:
          $ref: "#/components/schemas/classification"
        season:
          description: Season the product item belongs to
          type: string
          example: "SS2020"
        mime-type:
          type: string
          enum:
          - image/png
          - image/jpeg
          - image/jpg
          - video/mp4
          - video/H263
          - video/H264
          - video/H265
        resolution:
          $ref: "#/components/schemas/resolution"
        media-width:
          type: string
          example: "640px"
        media-height:
          type: string
          example: "640px" 
        size:
          description: size of the digital asset in bytes
          type: integer
          example: 543145
        url:
          type: string
          format: uri
          example: "https://dam.armani.it/asset/transform.EcomAr-8NAMA5_AMB5Z_UBSG-SS2023-D.300.jpg"
        creation-date:
          type: string
          format: date-time
        last-change-date:
          type: string
          format: date-time
        asset-metadata:
          $ref: "#/components/schemas/content-metadata"

    sketches-assets:
      type: object
      properties:
        asset-type:
          allOf:
            - $ref: "#/components/schemas/asset-type"
          example: sketch
        classification:
          $ref: "#/components/schemas/classification"
        year:
          description: Year the product item belongs to
          type: string
          example: "2023"
        season:
          description: Season the product item belongs to
          type: string
          example: "SS"
        creation-date:
          type: string
          format: date-time
        last-change-date:
          type: string
          format: date-time
        mime-type:
          type: string
          enum:
          - image/png
          - image/jpeg
          - image/jpg
          - video/mp4
          - video/H263
          - video/H264
          - video/H265
        media-width:
          type: string
          example: "640px"
        media-height:
          type: string
          example: "640px"
        asset-size:
          description: size of the digital asset in bytes
          type: integer
          example: 543145
        asset-url:
          type: string
          format: uri
          example: "https://storage.googleapis.com/armani-pharm-dev/XYZ010XOI69%40001-1.jpg?x-goog-signature=168458700bc2615b258a2c47d3a397f57b6927c686ee3cbdaa732c15a02fd7d1f6bb54ec03b248e8e907425df6d3ff7d97b2f471c1da3f70c6c802d9ece91a67fae0df9ec53745fa8a0a0a0999066dc67699ddffcbdf149a21a153ea3c83f950cf459bdc929ada2d2820be00375d562a748ab9c6cce3b79957e0c84e054efca78d56e3965fdedab25df7f720f720a09bdc0155d77b9e7cd0859c5c7c19e1167043946f59eb9c78a3092ff8c2a8cdd5500cc2138e692f5f059e0c7ca48cea223f9e91c45496e221961c63cf19719c6b63eeb580d245044ccc5b85ada7c324732107bd9f16af7128f9582c068f1a0555a3f18ed30e2c99fd28e3b2176ddc558a1a&x-goog-algorithm=GOOG4-RSA-SHA256&x-goog-credential=axl-endpoints-calls%40armani-photolab-dev.iam.gserviceaccount.com%2F20220826%2Feurope-west8%2Fstorage%2Fgoog4_request&x-goog-date=20220826T145217Z&x-goog-expires=3600&x-goog-signedheaders=host"
        content-metadata:
          $ref: "#/components/schemas/content-metadata"
          
    swatches-assets:
      type: object
      properties:
        asset-type:
          allOf:
            - $ref: "#/components/schemas/asset-type"
          example: swatch
        classification:
          $ref: "#/components/schemas/classification"
        year:
          description: Year the product item belongs to
          type: string
          example: "2023"
        season:
          description: Season the product item belongs to
          type: string
          example: "SS"
        creation-date:
          type: string
          format: date-time
        last-change-date:
          type: string
          format: date-time
        mime-type:
          type: string
          enum:
          - image/png
          - image/jpeg
          - image/jpg
          - video/mp4
          - video/H263
          - video/H264
          - video/H265
        media-width:
          type: string
          example: "640px"
        media-height:
          type: string
          example: "640px"
        asset-size:
          description: size of the digital asset in bytes
          type: integer
          example: 543145
        asset-url:
          type: string
          format: uri
          example: "https://storage.googleapis.com/armani-pharm-dev/XYZ010XOI69%40001-1.jpg?x-goog-signature=168458700bc2615b258a2c47d3a397f57b6927c686ee3cbdaa732c15a02fd7d1f6bb54ec03b248e8e907425df6d3ff7d97b2f471c1da3f70c6c802d9ece91a67fae0df9ec53745fa8a0a0a0999066dc67699ddffcbdf149a21a153ea3c83f950cf459bdc929ada2d2820be00375d562a748ab9c6cce3b79957e0c84e054efca78d56e3965fdedab25df7f720f720a09bdc0155d77b9e7cd0859c5c7c19e1167043946f59eb9c78a3092ff8c2a8cdd5500cc2138e692f5f059e0c7ca48cea223f9e91c45496e221961c63cf19719c6b63eeb580d245044ccc5b85ada7c324732107bd9f16af7128f9582c068f1a0555a3f18ed30e2c99fd28e3b2176ddc558a1a&x-goog-algorithm=GOOG4-RSA-SHA256&x-goog-credential=axl-endpoints-calls%40armani-photolab-dev.iam.gserviceaccount.com%2F20220826%2Feurope-west8%2Fstorage%2Fgoog4_request&x-goog-date=20220826T145217Z&x-goog-expires=3600&x-goog-signedheaders=host"
        content-metadata:
          $ref: "#/components/schemas/content-metadata"

    style:
      type: string
      example: "6LSG03"
      
    fabric:
      type: string
      example: "SM17Z"
      
    color:
      type: string
      example: "F8G8"
    
    brand:
      type: string
      enum:
        - EA
        - EA7
        - AX
        - GA
        - AJR
      example: "GA"

    mime-type:
      type: string
      enum:
        - image/jpg
        - image/jpeg
        - image/png
        - video/mp4
    
    classification:
      type: string
      enum:
        - main
        - all
      example: main

    resolution:
      type: string
      enum:
        - "300"
        - "600"
        - "1200"

    content-metadata:
      type: object
      properties:
        tag1:
          type: string
        tag2:
          type: string
        tag3:
          type: string  


    error:
      type: object
      properties:
        code:
          type: string
        reason:
          type: string
        message:
          type: string

    task-status:
      type: string
      enum:
        - Init
        - Waiting
        - In Progress
        - Failed
        - Complete

    unauthorized-error:
      type: object
      properties:
        code:
          type: string
          example: "401"
        reason:
          type: string
          example: "Not Authorized!"
        message:
          type: string
          example: Please check your authentication, api-key, basic auth, OAuth etc..."
          
    url-collection:
      type: object
      properties:
        brand:
          type: string
          enum:
            - GA
            - EA
            - EA7
            - AX
          example: "EA"
        year:
          type: string
          example: "2023"
        season:
          type: string
          enum:
            - SS
            - FW
          example: "SS"
        assets:
          type: array
          items:
            $ref: "#/components/schemas/asset-url"
            
    asset-url:
      type: object
      properties:
        item-id:
          description: identifier of the asset the url refers to (style-fabric-color)
          type: string
          example: "8NPPC1_PJ05Z_0544"
        url:
          description: publicly accessbile url
          type: string
          format: url
          example: "https://dam.armani.it/asset/transform.CHALCO-8NPPC1_PJ05Z_0544-SS2019-F.600.jpg"
        record-creation-date:
          type: string
          format: datetime
          example: "2022-12-06T14:14:34.211224"

