openapi: "3.0.0"
info:
  title: Digital Assets API
  description: Digital Assets API exposes the method to retrieve different types of digital assets - Version 2
  version: "2.0.0"
servers:
  - url: '{protocol}://{environment}.giorgioarmani.tech/digital-assets/v2'
    variables:
      protocol:
        enum:
          - https
        default: https
      environment:
        default: multimedia-api    # Prod Environment
        enum:
          - multimedia-api        # Prod Environment
          - dev-multimedia-api    # Dev Environment
          - test-multimedia-api   # Test Environment

paths:
  /media-items:
    get:
      description: Return URLs of media items for the specified item-id, i.e. images and / or video
      parameters:
        - name: style
          in: query
          description: ID of the style of the item the query refers to
          required: true
          schema:
            $ref: "#/components/schemas/style"
        - name: fabric
          in: query
          description: ID of the fabric of the item the query refers to
          required: true
          schema:
            $ref: "#/components/schemas/fabric"
        - name: color
          in: query
          description: ID of the color of the item the query refers to
          required: true
          schema: 
            $ref: "#/components/schemas/color"
        - name: category
          in: query
          description: Requester of the image (sales, web, social media)
          required: false
          schema:
            $ref: "#/components/schemas/category"
        - name: classification
          in: query
          description: The classification of the content, i.e. the views (main,front,side,back etc. )
          required: false
          explode: true
          schema:
            $ref: "#/components/schemas/classification"
        - name: season
          in: query
          description: The season the query refers to
          required: false
          schema:
            $ref: "#/components/schemas/season"
        - name: transaction-id
          in: header
          description: unique identifier of the transaction to be propagated to downstream servers, if not included by the Application calling the API it will be generated by the API Gateway
          required: false
          schema:
            type: string
            format: uuid
        - name: x-api-key
          in: header
          description: API Key assigned to the Application calling the API
          required: true
          schema:
            type: string
            
      responses:
        "200":
          description: Successful Operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/digital-assets"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "405":
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "429":
          description: Too Many Requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "502":
          description: Bad Gateway
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/error"
        "503":
          description: Service Not Available
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "504":
          description: Gateway Timeout
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
                
  /sketches:
    get:
      description: Return URLs of sketch(es) specified by the query parameters
      parameters:
        - name: style
          in: query
          description: ID of the style of the item the query refers to
          required: true
          schema:
            $ref: "#/components/schemas/style"
        - name: fabric
          in: query
          description: ID of the fabric of the item the query refers to
          required: false
          schema:
            $ref: "#/components/schemas/fabric"
        - name: color
          in: query
          description: ID of the color of the item the query refers to
          required: false
          schema:
            $ref: "#/components/schemas/color"
        - name: classification
          in: query
          description: The classification of the content, i.e. the views (main,front,side,back etc. )
          required: false
          explode: true
          schema:
            $ref: "#/components/schemas/classification"
        - name: transaction-id
          in: header
          description: unique identifier of the transaction to be propagated to downstream servers, if not included by the Application calling the API it will be generated by the API Gateway
          required: false
          schema:
            type: string
            format: uuid
        - name: x-api-key
          in: header
          description: API Key assigned to the Application calling the API
          required: true
          schema:
            type: string
            
      responses:
        "200":
          description: Successful Operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/sketches-digital-assets"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "405":
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "429":
          description: Too Many Requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "502":
          description: Bad Gateway
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/error"
        "503":
          description: Service Not Available
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "504":
          description: Gateway Timeout
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
                
  /swatches:
    get:
      description: Return URLs of swatches specified by the query parameters
      parameters:
        - name: style
          in: query
          description: ID of the style of the item the query refers to
          required: true
          schema:
            $ref: "#/components/schemas/style"
        - name: fabric
          in: query
          description: ID of the fabric of the item the query refers to
          required: true
          schema:
            $ref: "#/components/schemas/fabric"
        - name: color
          in: query
          description: ID of the color of the item the query refers to
          required: true
          schema: 
            $ref: "#/components/schemas/color"
        - name: category
          in: query
          description: The category the query refers to
          required: false
          schema:
            $ref: "#/components/schemas/category"
        - name: season
          in: query
          description: The season the query refers to
          required: false
          schema:
            $ref: "#/components/schemas/season"
        - name: transaction-id
          in: header
          description: unique identifier of the transaction to be propagated to downstream servers, if not included by the Application calling the API it will be generated by the API Gateway
          required: false
          schema:
            type: string
            format: uuid
        - name: x-api-key
          in: header
          description: API Key assigned to the Application calling the API
          required: true
          schema:
            type: string
            
      responses:
        "200":
          description: Successful Operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/swatches-digital-assets"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "405":
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "429":
          description: Too Many Requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "502":
          description: Bad Gateway
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/error"
        "503":
          description: Service Not Available
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "504":
          description: Gateway Timeout
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
                
  /media-items/brands/{brand-id}:
    get:
      description: Return list of items associated to the brand including their HREF
      parameters:
        - name: brand-id
          in: path
          description: The identifier of the brand the request refers to
          required: true
          schema:
            $ref: "#/components/schemas/brand"
        - name: season
          in: query
          description: The season the request refers to
          required: true
          schema:
            $ref: "#/components/schemas/season"
        - name: category
          in: query
          description: The category the request refers to (sales / web)
          required: false
          schema:
            $ref: "#/components/schemas/category"
        - name: item-category
          in: query
          description: The item category the request refers to (e.g. apparel, accessories etc.)
          required: false
          schema:
            $ref: "#/components/schemas/item-category"
        - name: item-sub-category
          in: query
          description: The item sub category the request refers go (e.g. leather, shoes etc.)
          required: false
          schema:
            $ref: "#/components/schemas/item-sub-category"
        - name: gender
          in: query
          description: The gender the request refers to (m/w/u)
          required: false
          schema:
            $ref: "#/components/schemas/gender"
        - name: asset-type
          in: query
          description: The type of asset the request refers to (image / video)
          required: false
          schema:
            $ref: "#/components/schemas/assetType"
        - name: transaction-id
          in: header
          description: unique identifier of the transaction to be propagated to downstream servers, if not included by the Application calling the API it will be generated by the API Gateway
          required: false
          schema:
            type: string
            format: uuid
        - name: x-api-key
          in: header
          description: API Key assigned to the Application calling the API
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Successful Operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/brand-digital-assets"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "405":
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "429":
          description: Too Many Requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "502":
          description: Bad Gateway
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/error"
        "503":
          description: Service Not Available
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
        "504":
          description: Gateway Timeout
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/error"
                    
security:
  - api-key-auth: []

components:

  securitySchemes:
    api-key-auth:
      type: apiKey
      in: header
      name: x-Gateway-APIKey

  schemas:
        
    brand-digital-assets:
      type: object
      description: object encapsulating the asset related information result of query on brand
      required:
        - brand
        - season
        - gender
        - category
        - asset-type
        - item-category
        - item-sub-category
        - count
        - assets
      properties:
        brand:
          $ref: "#/components/schemas/brand"
        seasson:
          $ref: "#/components/schemas/season"
        gender:
          description: Gender the product item refers to
          type: string
          example: "M"
        category:
          $ref: "#/components/schemas/category"
        asset-type:
          description: the type of the asset
          type: string
        item-category:
          allOf:
            - $ref: "#/components/schemas/item-category"
        item-sub-category:
          allOf:
            - $ref: "#/components/schemas/item-sub-category"
        count:
          description: Number of assets returned
          type: integer
          example: 1
        assets:
          description: Array of objets carrying the digital assets corresponding to the query parameters
          type: array
          items:
            $ref: "#/components/schemas/brand-assets"
        
    brand-assets:
      type: object
      description: object encapsulating the asset related information result of query on brand
      required:
        - item-id
        - item-category
        - item-sub-category
        - asset-last-change-date
        - href
      properties:
        item-id:
          description: The identifier of the item (style-fabric-color)
          type: string
          example: "2WHGK03H_T01QW_UC99"
        item-category:
          allOf:
            - $ref: "#/components/schemas/item-category"
        item-sub-category:
          allOf:
            - $ref: "#/components/schemas/item-sub-category"
        asset-last-change-date:
          description: The datetime when the last change was done in the index for the specific item
          type: string
          format: datetime
          example: "2022-05-04T13:22:42+00:00"
        href:
          description: The Hypertext Reference of the item identified by style-fabric-color
          type: string
          format: uri
          example: "https://multimedia-api.giorgioarmani.tech/digital-assets/v2/media-items?style=01K020&fabric=01146&color=611"
    
    sketches-digital-assets:
      type: object
      description: object encapsulating properties of the digitial asset
      required:
        - item-id-type
        - item-id
        - href
        - brand
        - gender
        - assets
      properties:
        item-id-type:
          description: type of item identifier (generic, sku, style)
          type: string
          example: "SFC"
        item-id:
          description: Unique identifier of the sketch
          type: string
          example: "2WHGK03H"
        style:
          description: The identifier of the style
          type: string
        fabric:
          description: The identifier of the fabric
          type: string
        color:
          description: The identifier of the color
          type: string
        brand:
          $ref: "#/components/schemas/brand"
        gender:
          description: Gender the product item refers to
          type: string
          example: "M"
        category:
          $ref: "#/components/schemas/category"
        count:
          description: Number of assets returned
          type: integer
          example: 1
        assets:
          description: Array of objets carrying the digital assets corresponding to the item
          type: array
          items:
            $ref: "#/components/schemas/sketches-assets"
            
    swatches-digital-assets:
      type: object
      description: object encapsulating properties of the digitial asset
      required:
        - item-id-type
        - item-id
        - href
        - brand
        - gender
        - assets
      properties:
        item-id-type:
          description: type of item identifier (generic, sku, style)
          type: string
          example: "SFC"
        item-id:
          description: Identifier of the item the swatch refers to
          type: string
          example: "Y4R173_Y068E_85726"
        style:
          description: The identifier of the style
          type: string
        fabric:
          description: The identifier of the fabric
          type: string
        color:
          description: The identifier of the color
          type: string
        brand:
          $ref: "#/components/schemas/brand"
        gender:
          description: Gender the product item refers to
          type: string
          example: "M"
        category:
          $ref: "#/components/schemas/category"
        count:
          description: Number of assets returned
          type: integer
          example: 1
        assets:
          description: Array of objets carrying the digital assets corresponding to the item
          type: array
          items:
            $ref: "#/components/schemas/swatches-assets"
            
    digital-assets:
      type: object
      description: object encapsulating properties of the digitial asset
      required:
        - item-id-type
        - item-id
        - href
        - brand
        - gender
        - assets
      properties:
        item-id-type:
          description: type of item identifier (generic, sku, style-fabric-color)
          type: string
          enum:
            - "SFC"
            - "SKU"
          example: "SFC"
        item-id:
          description: Unique identifier of the item (if item-id-type is SFC item-id is style_fabric_color)
          type: string
          example: "2WHGK03H_T01QW_UC99"
        style:
          description: The identifier of the style
          type: string
        fabric:
          description: The identifier of the fabric
          type: string
        color:
          description: The identifier of the color
          type: string
        href:
          description: The reference to the resource
          type: string
          format: URI
        brand:
          $ref: "#/components/schemas/brand"
        gender:
          description: Gender the product item refers to
          type: string
          example: "M"
        category:
          $ref: "#/components/schemas/category"
        count:
          description: Number of assets returned
          type: integer
          example: 1
        assets:
          description: Array of objets carrying the digital assets corresponding to the item
          type: array
          items:
            $ref: "#/components/schemas/assets"
        related-items:
          $ref: "#/components/schemas/related-items"
       
    
    related-items:
      type: object
      properties:
        sketches:
          type: array
          items:
            $ref: "#/components/schemas/sketch"
        swatches:
          type: array
          items:
            $ref: "#/components/schemas/swatch"
    
    sketch:
      type: object
      properties:
        item-id:
          type: string
        asset-size:
          description: The size in bytes of the sketch asset
          type: integer
        url:
          description: The URL of the sketch asset
          type: string
          format: uri
        href:
          type: string
          format: uri
        season:
          $ref: "#/components/schemas/season"

          
    swatch:
      type: object
      properties:
        item-id:
          type: string
        asset-size:
          description: The size in bytes of the sketch asset
          type: integer
        url:
          description: The URL of the sketch asset
          type: string
          format: uri
        href:
          type: string
          format: uri
        season:
          $ref: "#/components/schemas/season"
    
    assetType:
      type: string
      enum:
        - "image"
        - "video"
    gender:
      type: string
      enum:
        - "m"
        - "w"
        - "u"
    
    category:
      type: string
      enum:
        - "sales"
        - "web"
        - "social"
        - "general"
        - "all"
      example: web
      
    item-category:
      description: This is the category of the item
      type: string
      enum:
        - "apparel"
        - "accessories"
        - "classic"
        - "bodywear"
        
    item-sub-category:
      description: This is the sub-category of the item
      type: string
      enum:
        - "shoes"
        - "tie"
        - "textile"
        - "bijoux"
        - "leather"
        - "beachwear"
        - "socks"
        - "underwear"
      
    season:
      type: string
      example: "FW2022"

    asset-type:
      type: string
      enum:
        - image
        - video
        - 3d
        - swatch
        - sketch

    assets:
      type: object
      properties:
        asset-type:
          allOf:
            - $ref: "#/components/schemas/asset-type"
          example: image
        asset-category:
          $ref: "#/components/schemas/category"
        asset-classification:
          $ref: "#/components/schemas/classification"
        season:
          description: Season the product item belongs to
          type: string
          example: "SS2020"
        mime-type:
          type: string
          enum:
          - image/png
          - image/jpeg
          - image/jpg
          - video/mp4
          - video/H263
          - video/H264
          - video/H265

        media-width:
          type: string
          example: "640px"
        media-height:
          type: string
          example: "640px" 
        asset-size:
          description: The size of the digital asset in bytes
          type: integer
          example: 543145
        asset-url:
          type: string
          format: uri
        asset-last-change-date:
          type: string
          format: date-time
        creation-date:
          type: string
          format: date-time
        last-change-date:
          type: string
          format: date-time

    sketches-assets:
      type: object
      properties:
        asset-type:
          allOf:
            - $ref: "#/components/schemas/asset-type"
          example: image
        asset-category:
          $ref: "#/components/schemas/category"
        asset-classification:
          $ref: "#/components/schemas/classification"
        season:
          description: Season the product item belongs to
          type: string
          example: "SS2020"
        mime-type:
          type: string
          enum:
          - image/png
          - image/jpeg
          - image/jpg
          - video/mp4
          - video/H263
          - video/H264
          - video/H265
        media-width:
          type: string
          example: "640px"
        media-height:
          type: string
          example: "640px" 
        size:
          description: size of the digital asset in bytes
          type: integer
          example: 543145        
        asset-url:
          type: string
          format: uri
        asset-last-change-date:
          type: string
          format: date-time
        creation-date:
          type: string
          format: date-time
        last-change-date:
          type: string
          format: date-time
        href:
          type: string
          format: uri
          example: "https://multimedia-api.giorgioarmani.tech/digital-assets/v2/sketches?style=Y4R173"
          
    swatches-assets:
      type: object
      properties:
        asset-type:
          allOf:
            - $ref: "#/components/schemas/asset-type"
          example: swatch
        asset-category:
          $ref: "#/components/schemas/category"
        asset-classification:
          $ref: "#/components/schemas/classification"
        season:
          description: Season the product item belongs to
          type: string
          example: "SS2020"
        mime-type:
          type: string
          enum:
          - image/png
          - image/jpeg
          - image/jpg
          - video/mp4
          - video/H263
          - video/H264
          - video/H265
        media-width:
          type: string
          example: "640px"
        media-height:
          type: string
          example: "640px" 
        size:
          description: size of the digital asset in bytes
          type: integer
          example: 543145        
        asset-url:
          type: string
          format: uri
        asset-last-change-date:
          type: string
          format: date-time
        creation-date:
          type: string
          format: date-time
        last-change-date:
          type: string
          format: date-time
        href:
          type: string
          format: uri
          example: "https://multimedia-api.giorgioarmani.tech/digital-assets/v2/swatches?style=Y4R173&fabric=Y068E&color=85726"

    style:
      type: string
      example: "6LSG03"
      
    fabric:
      type: string
      example: "SM17Z"
      
    color:
      type: string
      example: "F8G8"
    
    brand:
      type: string
      enum:
        - "EA"
        - "EA7"
        - "AX"
        - "GA"
        - "AJR"
        - "10"
        - "30"
        - "67"
        - "70"
      example: "GA"
    
    classification:
      type: string


    error:
      type: object
      properties:
        code:
          type: string
        reason:
          type: string
        message:
          type: string
